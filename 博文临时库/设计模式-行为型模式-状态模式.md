# 状态模式

亦称： State

在一个对象的内部状态变化时改变其行为， 使其看上去就像改变了自身所属的类一样

状态模式与有限状态机的概念紧密相关，并且伴随着大量的条件语句（if/else和switch/case）







要点：

- 上下文：原始对象被称为*上下文* （context）， 它并不会自行实现所有行为， 而是会保存一个指向表示当前状态的状态对象的引用， 且将所有与状态相关的工作委派给该对象
- 

![](E:\_data\博文临时库\博文中的图片\状态模式.png)







- 对象需要根据自身当前状态进行不同行为， 同时状态的数量非常多且与状态相关的代码会频繁变更的话， 可使用状态模式

  - 在独立于其他状态的情况下添加新状态或修改已有状态

- 某个类需要根据成员变量的当前值改变自身行为

- 当相似状态和基于条件的状态机转换中存在许多重复代码时， 可使用状态模式

  状态模式让你能够生成状态**类层次**结构， 通过将公用代码抽取到抽象基类中来减少重复

- 如果状态机只有很少的几个状态， 或者很少发生改变， 那么应用该模式可能会显得小题大作

例子：

- 智能手机的按键和开关会根据设备当前状态完成不同行为：
  - 当手机处于解锁状态时， 按下按键将执行各种功能。
  - 当手机处于锁定状态时， 按下任何按键都将解锁屏幕。
  - 当手机电量不足时， 按下任何按键都将显示充电页面。

- 状态模式将根据当前回放状态， 让媒体播放器中的相同控件完成不同的行为

在 Java 语言中， 状态模式通常被用于将基于 `switch` 语句的大型状态机转换为对象。

这里是核心 Java 程序库中一些状态模式的示例：

- [`javax.faces.lifecycle.LifeCycle#execute()`](https://docs.oracle.com/javaee/7/api/javax/faces/lifecycle/Lifecycle.html#execute-javax.faces.context.FacesContext-) （由[ `Faces­Servlet`](https://docs.oracle.com/javaee/7/api/javax/faces/webapp/FacesServlet.html)控制： 行为依赖于当前 JSF 生命周期的阶段 （状态））

**识别方式：** 状态模式可通过受外部控制且能根据对象状态改变行为的方法来识别