所以 Git 是如何判断一个文件进行了何种修改的呢？（当文件修改了但是没有进入暂存区的时候）（每次都扫描一遍然后和上一个版本比对嘛？）



提交对象会包含：

- 指向暂存内容快照的指针
- 指向它的父对象的指针
  - 首次提交产生的提交对象没有父对象
  - 普通提交操作产生的提交对象有一个父对象
  - 而由多个分支合并产生的提交对象有多个父对象
- 作者的姓名和邮箱、提交时输入的信息



来看一个示例，看每个对象的生成过程，这有助于理解 Git 都做了什么：

（示例来自 Git 官方教程）

1. 假设现在有一个工作目录，里面包含了三个将要被暂存和提交的文件
2. 现在将三个文件暂存（`git add`），暂存操作会为每一个文件计算校验和，暂存后会把文件快照保存到 Git 仓库中。（即下图右边的三个 blob 对象）
3. 当使用 `git commit` 进行提交操作时，Git 会先计算每一个子目录（本例中只有项目根目录）的校验和， 然后在 Git 仓库中这些校验和保存为树对象。（即下图中间的 tree 对象）
   - 这个 tree 对象记录了目录结构
4. 当提交完成后，Git 便会创建一个提交对象（即下图左边的 commit 对象）， 它除了包含上面提到的那些信息外，还包含指向这个树对象（项目根目录）的指针。

![](https://git-scm.com/book/en/v2/images/commit-and-tree.png)

如果之后再进行提交，每次提交的对象就会包含一个指向上次提交的对象（父对象）的指针：

![](https://git-scm.com/book/en/v2/images/commits-and-parents.png)





Git 保存的不是文件的变化或者差异，而是一系列不同时刻的 **快照**

这个快照如何理解呢？

Git 对待数据更像是一个 快照流？快照如何理解？



<u>*todo： 为什么需要先add再commit：*</u>

- Ivony 的回答 - 知乎 https://www.zhihu.com/question/19946553/answer/29033220
- 蔡磊的回答 - 知乎 https://www.zhihu.com/question/19946553/answer/29068386
- 彭勇的回答 - 知乎 https://www.zhihu.com/question/19946553/answer/13759819